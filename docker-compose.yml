services:

  nginx:
    image: bensoil/meaningoflife-web:latest
    container_name: meaningoflife-web
    build: ./Nginx
    ports: 
      - "80:80"
    depends_on:
      - meaningoflife-api
    networks:
      - meaningoflife-network  

  meaningoflife-api:
    image: bensoil/meaningoflife-api:latest
    container_name: meaningoflife-api
    build: ./MeaningOfLife
    expose:
      - "8080"
    environment: 
      - ConnectionStrings__DefaultConnection=Host=meaningoflife-db;Database=MeaningOfLifeDb;Username=ga-app;Password=secret123;
    depends_on:
      - meaningoflife-db
    networks:
      - meaningoflife-network


  meaningoflife-db:
    image: bensoil/meaningoflife-db:latest
    container_name: meaningoflife-db
    build: ./MeaningOfLife-db
    environment:
      - POSTGRES_USER=ga-app
      - POSTGRES_PASSWORD=secret123
      - POSTGRES_DB=MeaningOfLifeDb
    ports:
    - "5432:5432"
    networks:
      - meaningoflife-network

networks:
  meaningoflife-network:
    driver: bridge

